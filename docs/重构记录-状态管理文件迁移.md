# 状态管理文件重构记录

## 重构概述

将原本放在 `src/hooks/` 目录下的状态管理文件迁移到新建的 `src/stores/` 目录，以更好地体现其职责和功能。

## 重构原因

1. **功能性质不匹配**：`useNote.ts` 和 `useUserPublicNotes.ts` 更像是全局状态管理器，而不是传统的 Vue hooks
2. **架构清晰度**：这些文件包含全局状态存储、数据库操作封装、完整的 CRUD 操作，属于应用层面的状态管理
3. **代码组织**：按功能职责组织代码，提高项目结构的可维护性

## 重构内容

### 新建目录结构

```
src/stores/
├── index.ts                    # 统一导出文件
├── notes.ts                   # 原 useNote.ts (已重命名)
└── publicNotes.ts             # 原 useUserPublicNotes.ts (已重命名)
```

### 文件迁移

- `src/hooks/useNote.ts` → `src/stores/noteStore.ts` → `src/stores/notes.ts`
- `src/hooks/useUserPublicNotes.ts` → `src/stores/userPublicNotesStore.ts` → `src/stores/publicNotes.ts`

### 导入路径更新

所有引用这两个文件的地方都已更新为从 `@/stores` 导入：

#### 更新的文件列表

1. `src/router/index.ts`
2. `src/views/HomePage.vue`
3. `src/views/DeletedPage.vue`
4. `src/views/UserPublicNotesPage.vue`
5. `src/views/FolderPage.vue`
6. `src/views/NoteDetail.vue`
7. `src/components/GlobalSearch/GlobalSearch.vue`
8. `src/components/NoteMove.vue`
9. `src/components/NoteMore.vue`
10. `src/components/LongPressMenu.vue`
11. `src/components/NoteList.vue`
12. `src/extensions/supabase/hooks/useSync.ts`
13. `src/hooks/useUserPublicNotesSync.ts`
14. `src/main.ts`

### 统一导出

创建了 `src/stores/index.ts` 文件，统一导出所有状态管理功能：

```typescript
// 笔记状态管理
export { getNotesSync, initializeNotes, useNote } from './notes'

// 用户公共笔记状态管理
export { getUserPublicNotesSync, initializeUserPublicNotes, useUserPublicNotes } from './publicNotes'
```

## 验证结果

- ✅ 所有文件引用已更新
- ✅ 项目构建成功 (`npm run build`)
- ✅ 没有遗留的旧路径引用
- ✅ TypeScript 类型检查通过

## 影响范围

此次重构仅涉及文件位置和导入路径的变更，**不影响任何业务逻辑和功能**，是一次纯粹的代码组织优化。

## 后续建议

1. 新的状态管理相关代码应放在 `src/stores/` 目录下
2. `src/hooks/` 目录专门用于可复用的组合式逻辑
3. 考虑进一步将相关的类型定义也迁移到对应的 store 文件中

---

**重构完成时间**: 2025年8月27日
**重构类型**: 代码组织优化
**影响**: 无功能影响，仅改善代码结构
